{
  "app-id": "com.deepin.Music",
  "branch": "3.1.6",
  "runtime": "com.deepin.Platform",
  "runtime-version": "15.5",
  "sdk": "com.deepin.Sdk",
  "command": "deepin-music",
  "separate-locales": false,
  "rename-desktop-file": "deepin-music.desktop",
  "rename-icon": "deepin-music",
  "tags": ["proprietary"],
  "finish-args": [
    /* X11 + XShm access */
    "--share=ipc", "--socket=x11",
    /* Sound access */
    "--socket=pulseaudio",
    /* Network access */
    "--share=network",
    /* OpenGL */
    "--filesystem=home",
    "--device=dri",
    "--own-name=org.mpris.MediaPlayer2.DeepinMusic"
  ],
  "modules": [
    "org.ffmpeg.FFmpeg.json",
    {
      "name": "taglib",
      "cmake": true,
      "config-opts": ["-DCMAKE_INSTALL_PREFIX=/app", "-DBUILD_SHARED_LIBS=ON"],
      "sources": [{
        "type": "archive",
        "url": "http://taglib.github.io/releases/taglib-1.11.1.tar.gz",
        "sha256": "b6d1a5a610aae6ff39d93de5efd0fdc787aa9e9dc1e7026fa4c961b26563526b"
      }]
    },
    {
      "name": "libcue",
      "cmake": true,
      "config-opts": ["-DCMAKE_INSTALL_PREFIX=/app", "-DBUILD_SHARED_LIBS=ON"],
      "sources": [{
        "type": "archive",
        "url": "https://github.com/lipnitsk/libcue/archive/v2.1.0.tar.gz",
        "sha256": "288ddd01e5f9e8f901d0c205d31507e4bdffd2540fa86073f2fe82de066d2abb"

      }]
    },
    {
      "name": "deepin-music",
      "no-autogen": true,
      "config-opts": ["PREFIX=/app", "-r"],
      "sources": [{
          "type": "git",
          "url": "https://cr.deepin.io/deepin-music",
          "branch": "3.1.6"
        },
        {
          "type": "script",
          "commands": [
                "sed -i 's@\\[QT_INSTALL_LIBS\\]@{PREFIX}/lib@' libdmusic/libdmusic.pro",
                "qmake PREFIX=/app"
            ],
          "dest-filename": "configure"
        }
      ]
    }
  ]
}
